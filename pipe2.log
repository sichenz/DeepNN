[2024-12-19 00:47:10] Running: python -m results.run-benchmark -c configs/config.yaml -l bootstrap
2024-12-19 00:47:11.262 | INFO     | __main__:main:23 - path_data=/Users/princess/dnn-paper/final_000
2024-12-19 00:47:11.263 | INFO     | __main__:main:24 - seed=0
2024-12-19 00:47:11.343 | WARNING  | __main__:main:45 - /Users/princess/dnn-paper/final_000/baselines/MXL_inventory.parquet does not exists (skipped)
2024-12-19 00:47:11.415 | INFO     | __main__:main:60 - merge coupons
2024-12-19 00:47:11.459 | INFO     | __main__:main:68 - build data subset indicators
2024-12-19 00:47:11.521 | INFO     | __main__:main:131 - compute metrics
2024-12-19 00:47:13.365 | INFO     | modules.scores:get_scores:75 - compute scores for for model DNN
2024-12-19 00:47:13.376 | INFO     | modules.scores:get_scores:75 - compute scores for for model LightGBM_Cat_Cross_ByJ
2024-12-19 00:47:13.382 | INFO     | modules.scores:get_scores:75 - compute scores for for model p
2024-12-19 00:47:13.412 | INFO     | modules.scores:get_scores:75 - compute scores for for model BinaryLogit_Cross_ByJ
2024-12-19 00:47:13.431 | INFO     | modules.scores:get_scores:75 - compute scores for for model LightGBM_Cross_ByJ
2024-12-19 00:47:13.746 | INFO     | __main__:main:140 - metrics computation done
2024-12-19 00:47:13.760 | INFO     | __main__:main:23 - path_data=/Users/princess/dnn-paper/final_001
2024-12-19 00:47:13.760 | INFO     | __main__:main:24 - seed=1
2024-12-19 00:47:13.827 | WARNING  | __main__:main:45 - /Users/princess/dnn-paper/final_001/baselines/MXL_inventory.parquet does not exists (skipped)
2024-12-19 00:47:13.902 | INFO     | __main__:main:60 - merge coupons
2024-12-19 00:47:13.942 | INFO     | __main__:main:68 - build data subset indicators
2024-12-19 00:47:14.001 | INFO     | __main__:main:131 - compute metrics
2024-12-19 00:47:14.080 | INFO     | modules.scores:get_scores:75 - compute scores for for model p
2024-12-19 00:47:14.099 | INFO     | modules.scores:get_scores:75 - compute scores for for model DNN
2024-12-19 00:47:14.120 | INFO     | modules.scores:get_scores:75 - compute scores for for model LightGBM_Cat_Cross_ByJ
2024-12-19 00:47:14.147 | INFO     | modules.scores:get_scores:75 - compute scores for for model LightGBM_Cross_ByJ
2024-12-19 00:47:14.174 | INFO     | modules.scores:get_scores:75 - compute scores for for model BinaryLogit_Cross_ByJ
2024-12-19 00:47:14.456 | INFO     | __main__:main:140 - metrics computation done
2024-12-19 00:47:14.468 | INFO     | __main__:main:23 - path_data=/Users/princess/dnn-paper/final_002
2024-12-19 00:47:14.468 | INFO     | __main__:main:24 - seed=2
2024-12-19 00:47:14.530 | WARNING  | __main__:main:45 - /Users/princess/dnn-paper/final_002/baselines/MXL_inventory.parquet does not exists (skipped)
2024-12-19 00:47:14.600 | INFO     | __main__:main:60 - merge coupons
2024-12-19 00:47:14.643 | INFO     | __main__:main:68 - build data subset indicators
2024-12-19 00:47:14.698 | INFO     | __main__:main:131 - compute metrics
2024-12-19 00:47:14.763 | INFO     | modules.scores:get_scores:75 - compute scores for for model p
2024-12-19 00:47:14.775 | INFO     | modules.scores:get_scores:75 - compute scores for for model DNN
2024-12-19 00:47:14.805 | INFO     | modules.scores:get_scores:75 - compute scores for for model LightGBM_Cat_Cross_ByJ
2024-12-19 00:47:14.823 | INFO     | modules.scores:get_scores:75 - compute scores for for model LightGBM_Cross_ByJ
2024-12-19 00:47:14.867 | INFO     | modules.scores:get_scores:75 - compute scores for for model BinaryLogit_Cross_ByJ
2024-12-19 00:47:15.163 | INFO     | __main__:main:140 - metrics computation done
[2024-12-19 00:47:15] Running: python -m uplift.elasticities -c configs/config.yaml -l bootstrap
2024-12-19 00:47:16.209 | INFO     | __main__:main:16 - Elasticity evaluation
2024-12-19 00:47:16.215 | INFO     | __main__:main:21 - path_data=/Users/princess/dnn-paper/final_000
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 0 = true
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 1 = uniform
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 2 = random
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 3 = logit_cross_by_j
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 4 = lightgbm_cross_by_j
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 5 = lightgbm_cat_cross_by_j
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 6 = mxl_inv
2024-12-19 00:47:16.215 | INFO     | __main__:main:31 - model 7 = dnn_model_010
2024-12-19 00:47:16.215 | INFO     | __main__:main:33 - discount=0.3
2024-12-19 00:47:16.215 | INFO     | __main__:main:34 - I=100
2024-12-19 00:47:16.215 | WARNING  | modules.lib:check_state:159 - `/Users/princess/dnn-paper/final_000/prob_uplift/results/elasticities_within.csv` exists, skipping /Users/princess/dnn-paper/final_000...
2024-12-19 00:47:16.215 | INFO     | __main__:main:16 - Elasticity evaluation
2024-12-19 00:47:16.222 | INFO     | __main__:main:21 - path_data=/Users/princess/dnn-paper/final_001
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 0 = true
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 1 = uniform
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 2 = random
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 3 = logit_cross_by_j
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 4 = lightgbm_cross_by_j
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 5 = lightgbm_cat_cross_by_j
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 6 = mxl_inv
2024-12-19 00:47:16.222 | INFO     | __main__:main:31 - model 7 = dnn_model_010
2024-12-19 00:47:16.222 | INFO     | __main__:main:33 - discount=0.3
2024-12-19 00:47:16.222 | INFO     | __main__:main:34 - I=100
2024-12-19 00:47:16.222 | WARNING  | modules.lib:check_state:159 - `/Users/princess/dnn-paper/final_001/prob_uplift/results/elasticities_within.csv` exists, skipping /Users/princess/dnn-paper/final_001...
2024-12-19 00:47:16.222 | INFO     | __main__:main:16 - Elasticity evaluation
2024-12-19 00:47:16.229 | INFO     | __main__:main:21 - path_data=/Users/princess/dnn-paper/final_002
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 0 = true
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 1 = uniform
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 2 = random
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 3 = logit_cross_by_j
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 4 = lightgbm_cross_by_j
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 5 = lightgbm_cat_cross_by_j
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 6 = mxl_inv
2024-12-19 00:47:16.229 | INFO     | __main__:main:31 - model 7 = dnn_model_010
2024-12-19 00:47:16.229 | INFO     | __main__:main:33 - discount=0.3
2024-12-19 00:47:16.229 | INFO     | __main__:main:34 - I=100
2024-12-19 00:47:16.229 | WARNING  | modules.lib:check_state:159 - `/Users/princess/dnn-paper/final_002/prob_uplift/results/elasticities_within.csv` exists, skipping /Users/princess/dnn-paper/final_002...
[2024-12-19 00:47:16] Running: python -m uplift.coupon-optim -c configs/config.yaml -l bootstrap
2024-12-19 00:47:16.897 | INFO     | __main__:main:104 - Coupon optimization
2024-12-19 00:47:16.903 | INFO     | __main__:main:109 - path_data=/Users/princess/dnn-paper/final_000
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 0 = true
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 1 = uniform
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 2 = random
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 3 = logit_cross_by_j
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 4 = lightgbm_cross_by_j
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 5 = lightgbm_cat_cross_by_j
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 6 = mxl_inv
2024-12-19 00:47:16.904 | INFO     | __main__:main:119 - model 7 = dnn_model_010
2024-12-19 00:47:16.904 | INFO     | __main__:main:123 - discount=0.3
2024-12-19 00:47:16.904 | INFO     | __main__:main:124 - I=100
2024-12-19 00:47:16.904 | WARNING  | modules.lib:check_state:159 - `/Users/princess/dnn-paper/final_000/prob_uplift/results/optim_revenue_uplift.csv` exists, skipping /Users/princess/dnn-paper/final_000...
2024-12-19 00:47:16.904 | INFO     | __main__:main:104 - Coupon optimization
2024-12-19 00:47:16.910 | INFO     | __main__:main:109 - path_data=/Users/princess/dnn-paper/final_001
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 0 = true
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 1 = uniform
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 2 = random
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 3 = logit_cross_by_j
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 4 = lightgbm_cross_by_j
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 5 = lightgbm_cat_cross_by_j
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 6 = mxl_inv
2024-12-19 00:47:16.910 | INFO     | __main__:main:119 - model 7 = dnn_model_010
2024-12-19 00:47:16.910 | INFO     | __main__:main:123 - discount=0.3
2024-12-19 00:47:16.910 | INFO     | __main__:main:124 - I=100
2024-12-19 00:47:16.910 | WARNING  | modules.lib:check_state:159 - `/Users/princess/dnn-paper/final_001/prob_uplift/results/optim_revenue_uplift.csv` exists, skipping /Users/princess/dnn-paper/final_001...
2024-12-19 00:47:16.910 | INFO     | __main__:main:104 - Coupon optimization
2024-12-19 00:47:16.916 | INFO     | __main__:main:109 - path_data=/Users/princess/dnn-paper/final_002
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 0 = true
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 1 = uniform
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 2 = random
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 3 = logit_cross_by_j
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 4 = lightgbm_cross_by_j
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 5 = lightgbm_cat_cross_by_j
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 6 = mxl_inv
2024-12-19 00:47:16.916 | INFO     | __main__:main:119 - model 7 = dnn_model_010
2024-12-19 00:47:16.916 | INFO     | __main__:main:123 - discount=0.3
2024-12-19 00:47:16.916 | INFO     | __main__:main:124 - I=100
2024-12-19 00:47:16.916 | WARNING  | modules.lib:check_state:159 - `/Users/princess/dnn-paper/final_002/prob_uplift/results/optim_revenue_uplift.csv` exists, skipping /Users/princess/dnn-paper/final_002...
[2024-12-19 00:47:16] Running: python -m paper.figure-2-data -c configs/config.yaml
[2024-12-19 00:47:18] Running: python -m paper.figure-2-mxl -c configs/config.yaml
2024-12-19 00:47:18.285 | INFO     | __main__:<module>:7 - Run MXL for Figure 2
path_data = /Users/princess/dnn-paper/final_009/figure-2
[2024-12-19 00:47:21] Running: python -m paper.table_1 -c configs/config.yaml -f paper -m log-loss
                      mean        se  mean_delta  se_delta
model                                                     
True Probabilities  0.0762  0.002714      0.0000  0.000000
Our Model           0.0834  0.002598      0.0072  0.000115
Binary Logit        0.0874  0.002944      0.0111  0.000346
LightGBM            0.0849  0.002598      0.0086  0.000115
LightGBM Category   0.0846  0.002540      0.0083  0.000115
[2024-12-19 00:47:22] Running: python -m paper.table_1 -c configs/config.yaml -f paper -m kl-divergence
                      mean        se  mean_delta  se_delta
model                                                     
True Probabilities  0.0000  0.000000      0.0000  0.000000
Our Model           0.0067  0.000346      0.0067  0.000346
Binary Logit        0.0216  0.000693      0.0216  0.000693
LightGBM            0.0069  0.000058      0.0069  0.000058
LightGBM Category   0.0063  0.000058      0.0063  0.000058
[2024-12-19 00:47:23] Running: python -m paper.table_2 -c configs/config.yaml -f paper
                    mean        se  mean_no_discount  se_no_discount
model                                                               
True Probabilities  1.00  0.000000              1.00        0.000000
Our Model           0.09  0.000000              0.01        0.005774
Binary Logit        0.15  0.005774             -0.03        0.034641
LightGBM            0.05  0.000000             -0.01        0.017321
LightGBM Category   0.08  0.005774              0.02        0.023094
[2024-12-19 00:47:23] Running: python -m paper.table_3 -c configs/config.yaml -f paper
type                          own  ...         cross_0
model                              ...                
True Probabilities  4.802 (0.026)  ...   0.000 (0.000)
Our Model           2.162 (0.043)  ...   0.036 (0.002)
Binary Logit        4.630 (0.141)  ...   0.000 (0.000)
LightGBM            3.539 (0.093)  ...  -0.044 (0.005)
LightGBM Category   3.270 (0.097)  ...  -0.097 (0.005)

[5 rows x 5 columns]
type                          own         within  ...      cross_neg        cross_0
model                                             ...                              
True Probabilities  0.000 (0.000)  0.000 (0.000)  ...  0.000 (0.000)  0.000 (0.000)
Our Model           2.642 (0.035)  0.403 (0.004)  ...  0.419 (0.020)  0.391 (0.008)
Binary Logit        1.183 (0.055)  0.205 (0.008)  ...  0.132 (0.007)  0.000 (0.000)
LightGBM            1.910 (0.041)  0.551 (0.011)  ...  0.540 (0.040)  0.487 (0.018)
LightGBM Category   2.133 (0.021)  0.526 (0.011)  ...  0.518 (0.048)  0.465 (0.018)

[5 rows x 5 columns]
[2024-12-19 00:47:24] Running: python -m paper.table_4 -c configs/config.yaml -f paper
                          Total          Own
model                                       
True Probabilities  0.46 (0.01)  0.35 (0.01)
Our Model           0.09 (0.00)  0.28 (0.00)
Binary Logit        0.18 (0.01)  0.28 (0.00)
LightGBM            0.07 (0.01)  0.24 (0.00)
LightGBM Category   0.10 (0.01)  0.25 (0.00)
Best Uniform True   0.10 (0.01)  0.09 (0.01)
Random              0.02 (0.00)  0.04 (0.00)
                           Total          Own
model                                        
True Probabilities   1.83 (0.08)  1.24 (0.07)
Our Model            0.01 (0.02)  0.78 (0.02)
Binary Logit         0.11 (0.03)  0.84 (0.04)
LightGBM             0.00 (0.02)  0.73 (0.03)
LightGBM Category    0.01 (0.01)  0.75 (0.04)
Best Uniform True    0.35 (0.04)  0.27 (0.00)
Random              -0.01 (0.00)  0.10 (0.01)
[2024-12-19 00:47:25] Running: python -m paper.figure-2-plot -c configs/config.yaml
[2024-12-19 00:47:26] Running: python -m paper.figure_3 -c configs/config.yaml
[2024-12-19 00:48:38] Pipeline completed successfully.
